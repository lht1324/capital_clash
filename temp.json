SELECT
    nsp.nspname AS schema_name,
    tbl.relname AS table_name,
    pol.polname AS policy_name,
    CASE pol.polcmd
        WHEN 'r' THEN 'SELECT'
        WHEN 'a' THEN 'INSERT'
        WHEN 'w' THEN 'UPDATE'
        WHEN 'd' THEN 'DELETE'
        WHEN '*' THEN 'ALL'
    END AS policy_command,
    pol.polpermissive AS is_permissive,
    (SELECT array_agg(rolname) FROM pg_roles WHERE oid = ANY(pol.polroles)) AS policy_roles,
    pg_get_expr(pol.polqual, pol.polrelid) AS policy_using_expression,
    pg_get_expr(pol.polwithcheck, pol.polrelid) AS policy_with_check_expression
FROM
    pg_policy pol
JOIN
    pg_class tbl ON tbl.oid = pol.polrelid
JOIN
    pg_namespace nsp ON nsp.oid = tbl.relnamespace
WHERE
    nsp.nspname = 'public'
ORDER BY
    table_name, policy_name;