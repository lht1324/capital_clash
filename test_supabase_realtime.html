<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supabase Realtime WebSocket Test</title>
</head>
<body>
    <h1>Supabase Realtime WebSocket Test</h1>
    <p>콘솔(F12)을 열어 연결 상태를 확인하세요.</p>

    <script>
        const SUPABASE_URL = 'https://azfjxkiykdztdarmenst.supabase.co'; // 여기에 실제 Supabase URL을 입력하세요 (예: https://your-project-ref.supabase.co)
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF6Zmp4a2l5a2R6dGRhcm1lbnN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5MTk3OTQsImV4cCI6MjA2NDQ5NTc5NH0.NIW1xRVfHsBZjOiZfZLsx0ut3LSESBAdCr5-47i3vxw'; // 여기에 실제 Supabase Anon Key를 입력하세요

        if (SUPABASE_URL === '' || SUPABASE_ANON_KEY === '') {
            console.error('Supabase URL 또는 Anon Key를 업데이트해야 합니다.');
        } else {
            const websocketUrl = `${SUPABASE_URL.replace('https://', 'wss://')}/realtime/v1/websocket?apikey=${SUPABASE_ANON_KEY}&eventsPerSecond=10&vsn=1.0.0`;
            console.log('WebSocket URL:', websocketUrl);

            const ws = new WebSocket(websocketUrl);

            ws.onopen = () => {
                console.log('WebSocket 연결 성공!');
                // 연결 후 채널 구독 메시지를 보낼 수 있습니다.
                // 이 테스트에서는 연결 성공 여부만 확인합니다.
            };

            ws.onmessage = (event) => {
                console.log('메시지 수신:', event.data);
            };

            ws.onerror = (error) => {
                console.error('WebSocket 오류 발생:', error);
            };

            ws.onclose = (event) => {
                console.log('WebSocket 연결 종료:', event);
                if (event.code !== 1000) { // 1000은 정상 종료 코드
                    console.error('WebSocket 비정상 종료:', event.code, event.reason);
                }
            };
        }
    </script>
</body>
</html>
